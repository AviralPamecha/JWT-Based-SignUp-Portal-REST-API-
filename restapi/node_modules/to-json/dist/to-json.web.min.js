!function(t,n){"function"==typeof define&&define.amd?define([],n):t.toJson=n()}(this,function(){var t,n,o,e,r,a,s={}.hasOwnProperty,i=function(t,n){function o(){this.constructor=t}for(var e in n)s.call(n,e)&&(t[e]=n[e]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},u=[].slice;return t=function(){function t(n,o){return this.data=n,this instanceof t?void(null!=o&&(this.dataKey=o.dataKey,this.jsonKey=o.jsonKey,this.parentContext=o.parentContext)):new t(this.data,o).apply()}return t.prototype.childContextClass=t,t.prototype.apply=function(t){return this._exclude()?void 0:(this._convertData(),this._excludeData()?void 0:(this._toJson(t),this._excludeJson()?void 0:this.json))},t.prototype._toJson=function(t){var n,o;this.json=t||null==(null!=(n=this.data)?n.toJson:void 0)||"function"!=typeof this.data.toJson?t||null==(null!=(o=this.data)?o.toJSON:void 0)||"function"!=typeof this.data.toJSON?this._getEnumerator()(this._toJsonNamed.bind(this)):this.data.toJSON():this.data.toJson(this)},t.prototype._getEnumeratorArray=function(){return function(t){return function(n){var o,e,r,a,s;for(t.json=[],s=t.data,r=e=0,a=s.length;a>e;r=++e)o=s[r],n(o,r,t._getJsonIndex(r));return t.json}}(this)},t.prototype._getEnumeratorObject=function(){return function(t){return function(n){var o,e,r;t.json={},e=t.data;for(o in e)s.call(e,o)&&(r=e[o],n(r,o,t._getJsonKey(o)));return t.json}}(this)},t.prototype._getEnumeratorValue=function(){return function(t){return function(){return t.json=t.data,t.json}}(this)},t.prototype._getEnumerator=function(){return Array.isArray(this.data)?this._getEnumeratorArray():"object"==typeof this.data&&null!==this.data?this._getEnumeratorObject():this._getEnumeratorValue()},t.prototype._toJsonNamed=function(t,n,o){var e,r;return e=this._createChildContext(t,n,o),r=e.apply(),void 0!==r&&(this.json[o]=r),e},t.prototype._createChildContext=function(t,n,o){return new this.childContextClass(t,{dataKey:n,jsonKey:o,parentContext:this})},t.prototype.adjustContext=function(t,n){var o,e;for(o in t)s.call(t,o)&&(e=t[o],this[o]=e);return n&&this.adjustChildContexts(t,n),this},t.prototype.adjustChildContexts=function(t,n){var o,e;this.childContextClass=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,t),n}(this.childContextClass);for(o in t)s.call(t,o)&&(e=t[o],this.childContextClass.prototype[o]=e);return n&&(this.childContextClass.prototype.childContextClass=this.childContextClass),this},t.prototype._super=function(t){var n,o;for(o=this[t],n=this.constructor;null!=n&&n.prototype[t]===o;)n=n.__super__.constructor;return n.prototype[t]},t.prototype._callSuper=function(){var t,n;return n=arguments[0],t=2<=arguments.length?u.call(arguments,1):[],this._super(n).apply(this,t)},t.prototype._getJsonKey=function(t){return t},t.prototype._getJsonIndex=function(t){return this.json.length},t.prototype._exclude=function(){return!1},t.prototype._convertData=function(){},t.prototype._excludeData=function(){return!1},t.prototype._excludeJson=function(){return!1},t.prototype.dataPath=function(){var t,n;for(n=[],t=this;null!=t;)null!=t.dataKey&&n.unshift(t.dataKey),t=t.parentContext;return n},t.prototype.jsonPath=function(){var t,n;for(n=[],t=this;null!=t;)null!=t.jsonKey&&n.unshift(t.jsonKey),t=t.parentContext;return n},t}(),e=function(t){function n(t,o){var e,r;n.__super__.constructor.call(this,t,o),this.pathMap=null!=(e=null!=(r=this.parentContext)?r.pathMap:void 0)?e:{}}return i(n,t),n.prototype.childContextClass=n,n.prototype._toJsonNamed=function(t,o,e){var r;return r=n.__super__._toJsonNamed.call(this,t,o,e),void 0!==this.json[e]&&(this.pathMap[r.jsonPath().join("/")]=r.dataPath().join("/")),r},n}(t),t.WithPathMap=e,a=function(t){var n;for(n in t)if(s.call(t,n))return!1;return!0},r=function(t){function n(t,o){n.__super__.constructor.call(this,t,o),this.pathTree={}}return i(n,t),n.prototype.childContextClass=n,n.prototype._toJsonNamed=function(t,o,e){var r;r=n.__super__._toJsonNamed.call(this,t,o,e),void 0!==this.json[e]&&(this.pathTree[r.jsonKey]=a(r.pathTree)?{id:r.dataKey}:{id:r.dataKey,children:r.pathTree})},n}(t),t.WithPathTree=r,n=function(t){function n(t,o){var e,r;n.__super__.constructor.call(this,t,o),this.dataMap=null!=(e=null!=(r=this.parentContext)?r.dataMap:void 0)?e:{}}return i(n,t),n.prototype.childContextClass=n,n.prototype._toJsonNamed=function(t,o,e){var r;return r=n.__super__._toJsonNamed.call(this,t,o,e),void 0!==this.json[e]&&(this.dataMap[r.jsonPath().join("/")]={dataPath:r.dataPath().join("/"),data:t,convertedData:r.data,json:this.json[e]}),r},n}(t),t.WithDataMap=n,o=function(t){function n(t,o){n.__super__.constructor.call(this,t,o),this.dataTree={}}return i(n,t),n.prototype.childContextClass=n,n.prototype._toJsonNamed=function(t,o,e){var r;return r=n.__super__._toJsonNamed.call(this,t,o,e),void 0!==this.json[e]&&(this.dataTree[r.jsonKey]={id:r.dataKey,data:t,convertedData:r.data,json:this.json[e]},a(r.dataTree)||(this.dataTree[r.jsonKey].children=r.dataTree)),r},n}(t),t.WithDataTree=o,t});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvLWpzb24uY29mZmVlIiwidG8tanNvbi53ZWIuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJ0b0pzb24iLCJ0aGlzIiwiVG9Kc29uIiwiVG9Kc29uV2l0aERhdGFNYXAiLCJUb0pzb25XaXRoRGF0YVRyZWUiLCJUb0pzb25XaXRoUGF0aE1hcCIsIlRvSnNvbldpdGhQYXRoVHJlZSIsImlzRW1wdHkiLCJoYXNQcm9wIiwiaGFzT3duUHJvcGVydHkiLCJleHRlbmQiLCJjaGlsZCIsInBhcmVudCIsImN0b3IiLCJjb25zdHJ1Y3RvciIsImtleSIsImNhbGwiLCJwcm90b3R5cGUiLCJfX3N1cGVyX18iLCJzbGljZSIsImRhdGExIiwib3B0aW9ucyIsImRhdGEiLCJkYXRhS2V5IiwianNvbktleSIsInBhcmVudENvbnRleHQiLCJhcHBseSIsImNoaWxkQ29udGV4dENsYXNzIiwiZXhjbHVkZUN1c3RvbVRvSnNvbiIsIl9leGNsdWRlIiwiX2NvbnZlcnREYXRhIiwiX2V4Y2x1ZGVEYXRhIiwiX3RvSnNvbiIsIl9leGNsdWRlSnNvbiIsImpzb24iLCJyZWYiLCJyZWYxIiwidG9KU09OIiwiX2dldEVudW1lcmF0b3IiLCJfdG9Kc29uTmFtZWQiLCJiaW5kIiwiX2dldEVudW1lcmF0b3JBcnJheSIsIl90aGlzIiwiY2IiLCJlbGVtZW50IiwiaSIsImllbGVtZW50IiwibGVuIiwibGVuZ3RoIiwiX2dldEpzb25JbmRleCIsIl9nZXRFbnVtZXJhdG9yT2JqZWN0IiwidmFsIiwiX2dldEpzb25LZXkiLCJfZ2V0RW51bWVyYXRvclZhbHVlIiwiQXJyYXkiLCJpc0FycmF5IiwiY2hpbGRDb250ZXh0IiwiX2NyZWF0ZUNoaWxkQ29udGV4dCIsImFkanVzdENvbnRleHQiLCJvdmVycmlkZXMiLCJzdGlja3kiLCJ2YWx1ZSIsImFkanVzdENoaWxkQ29udGV4dHMiLCJzdXBlckNsYXNzIiwiX0NsYXNzIiwiYXJndW1lbnRzIiwiX3N1cGVyIiwibmFtZSIsImNscyIsImN1cnJlbnQiLCJfY2FsbFN1cGVyIiwiYXJncyIsImRhdGFJbmRleCIsImRhdGFQYXRoIiwibm9kZSIsInBhdGgiLCJ1bnNoaWZ0IiwianNvblBhdGgiLCJwYXRoTWFwIiwiam9pbiIsIldpdGhQYXRoTWFwIiwib2JqIiwicGF0aFRyZWUiLCJpZCIsImNoaWxkcmVuIiwiV2l0aFBhdGhUcmVlIiwiZGF0YU1hcCIsImNvbnZlcnRlZERhdGEiLCJXaXRoRGF0YU1hcCIsImRhdGFUcmVlIiwiV2l0aERhdGFUcmVlIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUFBLGtCQUFBQyxTQUFBQSxPQUFBQyxJQ0VJRCxVQUFXRCxHQUVYRCxFQUFLSSxPQUFTSCxLREhsQkksS0FBQSxXQ01BLEdETkFDLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVDT0VDLEtETkZDLGVDT0VDLEVETEYsU0FBQUMsRUFBQUMsR0FBQSxRQUFBQyxLQUFBWixLQUFBYSxZQUFBSCxFQUFBLElBQUEsR0FBQUksS0FBQUgsR0FBQUosRUFBQVEsS0FBQUosRUFBQUcsS0FBQUosRUFBQUksR0FBQUgsRUFBQUcsR0FBQSxPQUFBRixHQUFBSSxVQUFBTCxFQUFBSyxVQUFBTixFQUFBTSxVQUFBLEdBQUFKLEdBQUFGLEVBQUFPLFVBQUFOLEVBQUFLLFVBQUFOLEdDTUVRLEtETEZBLEtDaVdBLE9BMVZBakIsR0RMQSxXQ01FLFFEWEZBLEdBQUFrQixFQUFBQyxHQVFBLE1DSUlwQixNRFpKcUIsS0FBQUYsRUFRQW5CLGVBQUFDLFFDTXFCLE1BQVhtQixJRGZWcEIsS0FBQXNCLFFBQUFGLEVBQUFFLFFDaUJRdEIsS0FBS3VCLFFBQVVILEVBQVFHLFFBQ3ZCdkIsS0FBS3dCLGNEUGJKLEVBQUFJLGdCQUtBLEdBQUF2QixHQUFBRCxLQUFBcUIsS0FBQUQsR0FBQUssUUFzS0EsTUM3SkV4QixHREZGZSxVQUFBVSxrQkFBQXpCLEVDSUVBLEVBQU9lLFVBQVVTLE1BQVEsU0FBU0UsR0RBcEMsTUFBQTNC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YWxDLEtBQzVCWSxLQUFNakMsS0FBS2lDLEtBQUtWLEtEN0R4QmdDLEdDbUVTckQsR0RqRVRELEdDcUVBQSxFRGxFQXNGLFlBQUFyRixFQ29FQUMsRUFBcUIsU0FBVTJELEdBRzdCLFFBQVMzRCxHQUFtQmtCLEVEbkU5QkQsR0FDQWpCLEVBQUFjLFVBQUFKLFlBQUFFLEtBQUFmLEtBQUFxQixFQUFBRCxHQUFBcEIsS0FBQXdGLFlDMEZFLE1BMUJBL0UsR0FBT04sRUFBb0IyRCxHQU8zQjNELEVEbkVGYSxVQUFBVSxrQkFEQXZCLEVDc0VFQSxFRG5FRmEsVUFBQXNCLGFBSEEsU0FBQWpCLEVBQUFDLEVBQUFDLEdDdUVJLEdEbkVKZ0MsRUFRQSxPQzRESUEsR0FBZXBELEVBQW1CYyxVQUFVcUIsYUFBYXZCLEtBQUtmLEtBQU1xQixFQUFNQyxFQUFTQyxHRGpFdkYsU0FBQXZCLEtBQUFpQyxLQUFBVixLQ21FTXZCLEtEbEVOd0YsU0FBQWpDLEVBQUFoQyxVQVRBMkQsR0FBQTNCLEVBQUFqQyxRQzZFUUQsS0FBTUEsRURsRWRpRSxjQUFBL0IsRUFBQWxDLEtBZEFZLEtBQUFqQyxLQUFBaUMsS0FBQVYsSUNvRldqQixFQUFRaUQsRUFBYWlDLFlBQ3hCeEYsS0FBS3dGLFNBQVNqQyxFQUFhaEMsU0FBUzRELFNBQVc1QixFQUFhaUMsV0RyRXBFakMsR0MyRVNwRCxHQUVORixHQUVIQSxFQUFPd0YsYUFBZXRGLEVBRWZGIiwiZmlsZSI6InRvLWpzb24ud2ViLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFRvSnNvblxyXG4gIGNvbnN0cnVjdG9yOiAoQGRhdGEsIG9wdGlvbnMpIC0+XHJcbiAgICBpZiBAIGluc3RhbmNlb2YgVG9Kc29uXHJcbiAgICAgICMgQ2FsbGVkIGFzIGNvbnN0cnVjdG9yXHJcbiAgICAgIGlmIG9wdGlvbnM/XHJcbiAgICAgICAgQGRhdGFLZXkgPSBvcHRpb25zLmRhdGFLZXlcclxuICAgICAgICBAanNvbktleSA9IG9wdGlvbnMuanNvbktleVxyXG4gICAgICAgIEBwYXJlbnRDb250ZXh0ID0gb3B0aW9ucy5wYXJlbnRDb250ZXh0XHJcbiAgICBlbHNlXHJcbiAgICAgICMgQ2FsbGVkIGFzIGZ1bmN0aW9uXHJcbiAgICAgIHJldHVybiAobmV3IFRvSnNvbihAZGF0YSwgb3B0aW9ucykpLmFwcGx5KClcclxuXHJcbiAgY2hpbGRDb250ZXh0Q2xhc3M6IEBcclxuXHJcbiAgIyBDb252ZXJ0cyBAZGF0YSBpbnRvIGpzb24gd2hpbHN0IGFwcGx5aW5nIGZpbHRlcnMgYW5kIGNvbnZlcnNpb25zXHJcbiAgYXBwbHk6IChleGNsdWRlQ3VzdG9tVG9Kc29uKSAtPlxyXG4gICAgIyBleGNsdWRlIGJlZm9yZSBkb2luZyBhbnl0aGluZz9cclxuICAgIGlmIEBfZXhjbHVkZSgpXHJcbiAgICAgIHJldHVybiB1bmRlZmluZWRcclxuXHJcbiAgICAjIGNvbnZlcnQgdGhlIGluY29taW5nIGRhdGEgKGNvbnRleHQuZGF0YSlcclxuICAgIEBfY29udmVydERhdGEoKVxyXG5cclxuICAgICMgZXhjbHVkZSBiYXNlZCBvbiB0aGUgY29udmVydGVkIGRhdGFcclxuICAgIGlmIEBfZXhjbHVkZURhdGEoKVxyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkXHJcblxyXG4gICAgIyBjb252ZXJ0IHRoZSBpbmNvbWluZyBkYXRhIChjb250ZXh0LmRhdGEpIGludG8gb3V0Z29pbmcgZGF0YSAoY29udGV4dC5qc29uKVxyXG4gICAgQF90b0pzb24oZXhjbHVkZUN1c3RvbVRvSnNvbilcclxuXHJcbiAgICAjIGV4Y2x1ZGUgYmFzZWQgb24gb3V0Z29pbmcgZGF0YT9cclxuICAgIGlmIEBfZXhjbHVkZUpzb24oKVxyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkXHJcblxyXG4gICAgIyByZXR1cm4gdGhlIG91dGdvaW5nIGRhdGEgKGNvbnRleHQuanNvbilcclxuICAgIHJldHVybiBAanNvblxyXG5cclxuICAjIENvbnZlcnRzIEBkYXRhIGludG8ganNvblxyXG4gIF90b0pzb246IChleGNsdWRlQ3VzdG9tVG9Kc29uKSAtPlxyXG4gICAgaWYgbm90IGV4Y2x1ZGVDdXN0b21Ub0pzb24gYW5kIEBkYXRhPy50b0pzb24/IGFuZCB0eXBlb2YgQGRhdGEudG9Kc29uID09ICdmdW5jdGlvbidcclxuICAgICAgQGpzb24gPSBAZGF0YS50b0pzb24oQClcclxuICAgIGVsc2UgaWYgbm90IGV4Y2x1ZGVDdXN0b21Ub0pzb24gYW5kIEBkYXRhPy50b0pTT04/IGFuZCB0eXBlb2YgQGRhdGEudG9KU09OID09ICdmdW5jdGlvbidcclxuICAgICAgQGpzb24gPSBAZGF0YS50b0pTT04oKVxyXG4gICAgZWxzZVxyXG4gICAgICBAanNvbiA9IEBfZ2V0RW51bWVyYXRvcigpKEBfdG9Kc29uTmFtZWQuYmluZChAKSlcclxuICAgIHJldHVyblxyXG5cclxuICAjIFJldHVybnMgYW4gZW51bWVyYXRvciB3aGljaCBpdGVyYXRlcyBvdmVyIEBkYXRhIGFzIGFuIGFycmF5LCByZXR1cm5pbmcgdGhlIHJlc3VsdGluZyBqc29uXHJcbiAgX2dldEVudW1lcmF0b3JBcnJheTogKCkgLT5cclxuICAgIHJldHVybiAoY2IpID0+XHJcbiAgICAgIEBqc29uID0gW11cclxuICAgICAgZm9yIGVsZW1lbnQsIGllbGVtZW50IGluIEBkYXRhXHJcbiAgICAgICAgY2IoZWxlbWVudCwgaWVsZW1lbnQsIEBfZ2V0SnNvbkluZGV4KGllbGVtZW50KSlcclxuICAgICAgcmV0dXJuIEBqc29uXHJcblxyXG4gICMgUmV0dXJucyBhbiBlbnVtZXJhdG9yIHdoaWNoIGl0ZXJhdGVzIG92ZXIgQGRhdGEgYXMgYW4gb2JqZWN0LCByZXR1cm5pbmcgdGhlIHJlc3VsdGluZyBqc29uXHJcbiAgX2dldEVudW1lcmF0b3JPYmplY3Q6ICgpIC0+XHJcbiAgICByZXR1cm4gKGNiKSA9PlxyXG4gICAgICBAanNvbiA9IHt9XHJcbiAgICAgIGZvciBvd24ga2V5LCB2YWwgb2YgQGRhdGFcclxuICAgICAgICBjYih2YWwsIGtleSwgQF9nZXRKc29uS2V5KGtleSkpXHJcbiAgICAgIHJldHVybiBAanNvblxyXG5cclxuICAjIFJldHVybnMgYW4gZW51bWVyYXRvciB3aGljaCBzaW1wbHkgcmV0dXJucyBAZGF0YVxyXG4gIF9nZXRFbnVtZXJhdG9yVmFsdWU6ICgpIC0+XHJcbiAgICByZXR1cm4gKCkgPT5cclxuICAgICAgQGpzb24gPSBAZGF0YVxyXG4gICAgICByZXR1cm4gQGpzb25cclxuXHJcbiAgIyBSZXR1cm5zIGFuIGVudW1lcmF0b3Igd2hpY2ggZW51bWVyYXRlcyBvdmVyIGRhdGEsIHJldHVybmluZyB0aGUgcmVzdWx0aW5nIGpzb25cclxuICBfZ2V0RW51bWVyYXRvcjogKCkgLT5cclxuICAgIGlmIEFycmF5LmlzQXJyYXkoQGRhdGEpXHJcbiAgICAgIHJldHVybiBAX2dldEVudW1lcmF0b3JBcnJheSgpXHJcbiAgICBlbHNlIGlmIHR5cGVvZiBAZGF0YSA9PSAnb2JqZWN0JyBhbmQgQGRhdGEgIT0gbnVsbFxyXG4gICAgICByZXR1cm4gQF9nZXRFbnVtZXJhdG9yT2JqZWN0KClcclxuICAgIGVsc2VcclxuICAgICAgcmV0dXJuIEBfZ2V0RW51bWVyYXRvclZhbHVlKClcclxuXHJcbiAgIyNcclxuICAjIFN0YW5kYXJkIGNhbGxiYWNrIHVzZWQgaW4gZW51bWVyYXRvcnMuXHJcbiAgIyBAcGFyYW0gZGF0YSAtIGRhdGEgdG8gYmUgY29udmVydGVkXHJcbiAgIyBAcGFyYW0gZGF0YUtleSB7c3RyaW5nfGludH0gLSBrZXkvaW5kZXggaW50byB0aGUgcGFyZW50IHNvdXJjZSBkYXRhIGFzIGRldGVybWluZWQgYnkgdGhlIGVudW1lcmF0b3JcclxuICAjIEBwYXJhbSBqc29uS2V5IHtzdHJpbmd8aW50fSAtIGtleS9pbmRleCBpbnRvIHRoZSBqc29uIHRhcmdldCBkYXRhIGFzIGRldGVybWluZWQgYnkgdGhlIGVudW1lcmF0b3JcclxuICAjIEByZXR1cm4ge3RvSnNvbn0gY2hpbGQgY29udGV4dFxyXG4gIF90b0pzb25OYW1lZDogKGRhdGEsIGRhdGFLZXksIGpzb25LZXkpIC0+XHJcbiAgICBjaGlsZENvbnRleHQgPSBAX2NyZWF0ZUNoaWxkQ29udGV4dChkYXRhLCBkYXRhS2V5LCBqc29uS2V5KVxyXG5cclxuICAgIGpzb24gPSBjaGlsZENvbnRleHQuYXBwbHkoKVxyXG5cclxuICAgIGlmIGpzb24gIT0gdW5kZWZpbmVkXHJcbiAgICAgIEBqc29uW2pzb25LZXldID0ganNvblxyXG5cclxuICAgIHJldHVybiBjaGlsZENvbnRleHRcclxuXHJcbiAgIyByZXR1cm5zIGEgbmV3IGNvbnRleHQgZm9yIHVzZSB3aXRoIGNoaWxkIGRhdGFcclxuICAjIGFyZ3VtZW50cyBhcmUgdGhlIHNhbWUgYXMgdGhvc2UgZ2l2ZW4gdG8gQF90b0pzb25OYW1lZFxyXG4gIF9jcmVhdGVDaGlsZENvbnRleHQ6IChkYXRhLCBkYXRhS2V5LCBqc29uS2V5KSAtPlxyXG4gICAgcmV0dXJuIG5ldyBAY2hpbGRDb250ZXh0Q2xhc3MoXHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIHtcclxuICAgICAgICBkYXRhS2V5OiBkYXRhS2V5XHJcbiAgICAgICAganNvbktleToganNvbktleVxyXG4gICAgICAgIHBhcmVudENvbnRleHQ6IEBcclxuICAgICAgfVxyXG4gICAgKVxyXG5cclxuICAjIFV0aWxpdHkgZnVuY3Rpb24gZm9yIG92ZXJyaWRpbmcgY2hpbGQgY29udGV4dCBtZXRob2RzXHJcbiAgIyBVc2VmdWwgZm9yIGFwcGx5aW5nIHZhcmlvdXMgZmlsdGVycyBldGMgZm9yIHRoZSBjdXJyZW50IGNvbnRleHRcclxuICBhZGp1c3RDb250ZXh0OiAob3ZlcnJpZGVzLCBzdGlja3kpIC0+XHJcbiAgICBmb3Igb3duIGtleSwgdmFsdWUgb2Ygb3ZlcnJpZGVzXHJcbiAgICAgIEBba2V5XSA9IHZhbHVlXHJcblxyXG4gICAgaWYgc3RpY2t5XHJcbiAgICAgIEBhZGp1c3RDaGlsZENvbnRleHRzKG92ZXJyaWRlcywgc3RpY2t5KVxyXG4gICAgcmV0dXJuIEBcclxuXHJcbiAgIyBVdGlsaXR5IGZ1bmN0aW9uIGZvciBvdmVycmlkaW5nIGNoaWxkIGNvbnRleHQgbWV0aG9kc1xyXG4gICMgVXNlZnVsIGZvciBhcHBseWluZyB2YXJpb3VzIGZpbHRlcnMgZXRjIGZvciBvbmx5IHRoZSBpbW1lZGlhdGUgY2hpbGQgY2xhc3Nlc1xyXG4gICMgQHBhcmFtIHtCb29sZWFufSBzdGlja3kgLSBJZiBUcnVlLCBhbGwgZnV0dXJlIGdlbmVyYXRpb25zIHdpbGwgYmUgb3ZlcnJpZGRlblxyXG4gIGFkanVzdENoaWxkQ29udGV4dHM6IChvdmVycmlkZXMsIHN0aWNreSkgLT5cclxuICAgIEBjaGlsZENvbnRleHRDbGFzcyA9IGNsYXNzIGV4dGVuZHMgQGNoaWxkQ29udGV4dENsYXNzXHJcbiAgICBmb3Igb3duIGtleSwgdmFsdWUgb2Ygb3ZlcnJpZGVzXHJcbiAgICAgIEBjaGlsZENvbnRleHRDbGFzcy5wcm90b3R5cGVba2V5XSA9IHZhbHVlXHJcbiAgICBpZiBzdGlja3lcclxuICAgICAgQGNoaWxkQ29udGV4dENsYXNzLnByb3RvdHlwZS5jaGlsZENvbnRleHRDbGFzcyA9IEBjaGlsZENvbnRleHRDbGFzc1xyXG4gICAgcmV0dXJuIEBcclxuXHJcbiAgIyB1dGlsaXR5IGZ1bmN0aW9uIGZvciBjaGFpbmluZyBzdXBlciBtZXRob2RzXHJcbiAgX3N1cGVyOiAobmFtZSkgLT5cclxuICAgIGN1cnJlbnQgPSBAW25hbWVdXHJcbiAgICBjbHMgPSBAY29uc3RydWN0b3JcclxuICAgIHdoaWxlIGNscz8gYW5kIGNscy5wcm90b3R5cGVbbmFtZV0gPT0gY3VycmVudFxyXG4gICAgICBjbHMgPSBjbHMuX19zdXBlcl9fLmNvbnN0cnVjdG9yXHJcbiAgICByZXR1cm4gY2xzLnByb3RvdHlwZVtuYW1lXVxyXG5cclxuICBfY2FsbFN1cGVyOiAobmFtZSwgYXJncy4uLikgLT5cclxuICAgIEBfc3VwZXIobmFtZSkuYXBwbHkoQCwgYXJncylcclxuXHJcbiAgIyBSZXR1cm5zIHRoZSBrZXkgdG8gdXNlIGZvciB0aGUganNvbiBvdXRwdXRcclxuICBfZ2V0SnNvbktleTogKGRhdGFLZXkpIC0+XHJcbiAgICBkYXRhS2V5XHJcblxyXG4gICMgUmV0dXJucyB0aGUga2V5IHRvIHVzZSBmb3IgdGhlIGpzb24gb3V0cHV0XHJcbiAgX2dldEpzb25JbmRleDogKGRhdGFJbmRleCkgLT5cclxuICAgIEBqc29uLmxlbmd0aFxyXG5cclxuICAjIGV4Y2x1ZGUgYmVmb3JlIGRvaW5nIGFueXRoaW5nP1xyXG4gIF9leGNsdWRlOiAoKSAtPlxyXG4gICAgZmFsc2VcclxuXHJcbiAgIyBjb252ZXJ0IHRoZSBpbmNvbWluZyBkYXRhXHJcbiAgX2NvbnZlcnREYXRhOiAoKSAtPlxyXG4gICAgcmV0dXJuXHJcblxyXG4gICMgZXhjbHVkZSBiYXNlZCBvbiB0aGUgY29udmVydGVkIGRhdGFcclxuICBfZXhjbHVkZURhdGE6ICgpIC0+XHJcbiAgICBmYWxzZVxyXG5cclxuICAjIGV4Y2x1ZGUgYmFzZWQgb24gb3V0Z29pbmcgZGF0YT9cclxuICBfZXhjbHVkZUpzb246ICgpIC0+XHJcbiAgICBmYWxzZVxyXG5cclxuICAjIHJldHVybiBkYXRhIHBhdGggZm9yIHRoaXMgY29udGV4dFxyXG4gIGRhdGFQYXRoOiAoKSAtPlxyXG4gICAgcGF0aCA9IFtdXHJcbiAgICBub2RlID0gQFxyXG4gICAgd2hpbGUgbm9kZT9cclxuICAgICAgaWYgbm9kZS5kYXRhS2V5P1xyXG4gICAgICAgIHBhdGgudW5zaGlmdChub2RlLmRhdGFLZXkpXHJcbiAgICAgIG5vZGUgPSBub2RlLnBhcmVudENvbnRleHRcclxuICAgIHJldHVybiBwYXRoXHJcblxyXG4gICMgcmV0dXJuIGpzb24gcGF0aCBmb3IgdGhpcyBjb250ZXh0XHJcbiAganNvblBhdGg6ICgpIC0+XHJcbiAgICBwYXRoID0gW11cclxuICAgIG5vZGUgPSBAXHJcbiAgICB3aGlsZSBub2RlP1xyXG4gICAgICBpZiBub2RlLmpzb25LZXk/XHJcbiAgICAgICAgcGF0aC51bnNoaWZ0KG5vZGUuanNvbktleSlcclxuICAgICAgbm9kZSA9IG5vZGUucGFyZW50Q29udGV4dFxyXG4gICAgcmV0dXJuIHBhdGhcclxuXHJcbmNsYXNzIFRvSnNvbldpdGhQYXRoTWFwIGV4dGVuZHMgVG9Kc29uXHJcbiAgY29uc3RydWN0b3I6IChkYXRhLCBvcHRpb25zKSAtPlxyXG4gICAgc3VwZXIoZGF0YSwgb3B0aW9ucylcclxuXHJcbiAgICBAcGF0aE1hcCA9IEBwYXJlbnRDb250ZXh0Py5wYXRoTWFwID8ge31cclxuXHJcbiAgY2hpbGRDb250ZXh0Q2xhc3M6IEBcclxuXHJcbiAgX3RvSnNvbk5hbWVkOiAoZGF0YSwgZGF0YUtleSwganNvbktleSkgLT5cclxuICAgIGNoaWxkQ29udGV4dCA9IHN1cGVyKGRhdGEsIGRhdGFLZXksIGpzb25LZXkpXHJcblxyXG4gICAgaWYgQGpzb25banNvbktleV0gIT0gdW5kZWZpbmVkXHJcbiAgICAgIEBwYXRoTWFwW2NoaWxkQ29udGV4dC5qc29uUGF0aCgpLmpvaW4oJy8nKV0gPSBjaGlsZENvbnRleHQuZGF0YVBhdGgoKS5qb2luKCcvJylcclxuXHJcbiAgICByZXR1cm4gY2hpbGRDb250ZXh0XHJcblxyXG5Ub0pzb24uV2l0aFBhdGhNYXAgPSBUb0pzb25XaXRoUGF0aE1hcFxyXG5cclxuaXNFbXB0eSA9IChvYmopIC0+XHJcbiAgZm9yIG93biBrZXkgb2Ygb2JqXHJcbiAgICByZXR1cm4gZmFsc2VcclxuICByZXR1cm4gdHJ1ZVxyXG5cclxuY2xhc3MgVG9Kc29uV2l0aFBhdGhUcmVlIGV4dGVuZHMgVG9Kc29uXHJcbiAgY29uc3RydWN0b3I6IChkYXRhLCBvcHRpb25zKSAtPlxyXG4gICAgc3VwZXIoZGF0YSwgb3B0aW9ucylcclxuXHJcbiAgICBAcGF0aFRyZWUgPSB7fVxyXG5cclxuICBjaGlsZENvbnRleHRDbGFzczogQFxyXG5cclxuICBfdG9Kc29uTmFtZWQ6IChkYXRhLCBkYXRhS2V5LCBqc29uS2V5KSAtPlxyXG4gICAgY2hpbGRDb250ZXh0ID0gc3VwZXIoZGF0YSwgZGF0YUtleSwganNvbktleSlcclxuXHJcbiAgICBpZiBAanNvbltqc29uS2V5XSAhPSB1bmRlZmluZWRcclxuICAgICAgaWYgbm90IGlzRW1wdHkoY2hpbGRDb250ZXh0LnBhdGhUcmVlKVxyXG4gICAgICAgIEBwYXRoVHJlZVtjaGlsZENvbnRleHQuanNvbktleV0gPSB7XHJcbiAgICAgICAgICBpZDogY2hpbGRDb250ZXh0LmRhdGFLZXksXHJcbiAgICAgICAgICBjaGlsZHJlbjogY2hpbGRDb250ZXh0LnBhdGhUcmVlXHJcbiAgICAgICAgfVxyXG4gICAgICBlbHNlXHJcbiAgICAgICAgQHBhdGhUcmVlW2NoaWxkQ29udGV4dC5qc29uS2V5XSA9IHtcclxuICAgICAgICAgIGlkOiBjaGlsZENvbnRleHQuZGF0YUtleVxyXG4gICAgICAgIH1cclxuXHJcbiAgICByZXR1cm5cclxuXHJcblRvSnNvbi5XaXRoUGF0aFRyZWUgPSBUb0pzb25XaXRoUGF0aFRyZWVcclxuXHJcbmNsYXNzIFRvSnNvbldpdGhEYXRhTWFwIGV4dGVuZHMgVG9Kc29uXHJcbiAgY29uc3RydWN0b3I6IChkYXRhLCBvcHRpb25zKSAtPlxyXG4gICAgc3VwZXIoZGF0YSwgb3B0aW9ucylcclxuXHJcbiAgICBAZGF0YU1hcCA9IEBwYXJlbnRDb250ZXh0Py5kYXRhTWFwID8ge31cclxuXHJcbiAgY2hpbGRDb250ZXh0Q2xhc3M6IEBcclxuXHJcbiAgX3RvSnNvbk5hbWVkOiAoZGF0YSwgZGF0YUtleSwganNvbktleSkgLT5cclxuICAgIGNoaWxkQ29udGV4dCA9IHN1cGVyKGRhdGEsIGRhdGFLZXksIGpzb25LZXkpXHJcblxyXG4gICAgaWYgQGpzb25banNvbktleV0gIT0gdW5kZWZpbmVkXHJcbiAgICAgIEBkYXRhTWFwW2NoaWxkQ29udGV4dC5qc29uUGF0aCgpLmpvaW4oJy8nKV0gPSB7XHJcbiAgICAgICAgZGF0YVBhdGg6IGNoaWxkQ29udGV4dC5kYXRhUGF0aCgpLmpvaW4oJy8nKVxyXG4gICAgICAgIGRhdGE6IGRhdGFcclxuICAgICAgICBjb252ZXJ0ZWREYXRhOiBjaGlsZENvbnRleHQuZGF0YVxyXG4gICAgICAgIGpzb246IEBqc29uW2pzb25LZXldXHJcbiAgICAgIH1cclxuXHJcbiAgICByZXR1cm4gY2hpbGRDb250ZXh0XHJcblxyXG5Ub0pzb24uV2l0aERhdGFNYXAgPSBUb0pzb25XaXRoRGF0YU1hcFxyXG5jbGFzcyBUb0pzb25XaXRoRGF0YVRyZWUgZXh0ZW5kcyBUb0pzb25cclxuICBjb25zdHJ1Y3RvcjogKGRhdGEsIG9wdGlvbnMpIC0+XHJcbiAgICBzdXBlcihkYXRhLCBvcHRpb25zKVxyXG5cclxuICAgIEBkYXRhVHJlZSA9IHt9XHJcblxyXG4gIGNoaWxkQ29udGV4dENsYXNzOiBAXHJcblxyXG4gIF90b0pzb25OYW1lZDogKGRhdGEsIGRhdGFLZXksIGpzb25LZXkpIC0+XHJcbiAgICBjaGlsZENvbnRleHQgPSBzdXBlcihkYXRhLCBkYXRhS2V5LCBqc29uS2V5KVxyXG5cclxuICAgIGlmIEBqc29uW2pzb25LZXldICE9IHVuZGVmaW5lZFxyXG4gICAgICBAZGF0YVRyZWVbY2hpbGRDb250ZXh0Lmpzb25LZXldID0ge1xyXG4gICAgICAgIGlkOiBjaGlsZENvbnRleHQuZGF0YUtleVxyXG4gICAgICAgIGRhdGE6IGRhdGFcclxuICAgICAgICBjb252ZXJ0ZWREYXRhOiBjaGlsZENvbnRleHQuZGF0YVxyXG4gICAgICAgIGpzb246IEBqc29uW2pzb25LZXldXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIG5vdCBpc0VtcHR5KGNoaWxkQ29udGV4dC5kYXRhVHJlZSlcclxuICAgICAgICBAZGF0YVRyZWVbY2hpbGRDb250ZXh0Lmpzb25LZXldLmNoaWxkcmVuID0gY2hpbGRDb250ZXh0LmRhdGFUcmVlXHJcblxyXG4gICAgcmV0dXJuIGNoaWxkQ29udGV4dFxyXG5cclxuVG9Kc29uLldpdGhEYXRhVHJlZSA9IFRvSnNvbldpdGhEYXRhVHJlZVxyXG4iLG51bGxdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==